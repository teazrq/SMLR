<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 11 Logistic Regression Basics | Statistical Learning and Machine Learning with R</title>
  <meta name="description" content="A textbook for STAT 542 and 432 at UIUC" />
  <meta name="generator" content="bookdown 0.24 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 11 Logistic Regression Basics | Statistical Learning and Machine Learning with R" />
  <meta property="og:type" content="book" />
  <meta property="og:url" content="https://teazrq.github.io/SMLR/" />
  
  <meta property="og:description" content="A textbook for STAT 542 and 432 at UIUC" />
  <meta name="github-repo" content="teazrq/SMLR" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 11 Logistic Regression Basics | Statistical Learning and Machine Learning with R" />
  
  <meta name="twitter:description" content="A textbook for STAT 542 and 432 at UIUC" />
  

<meta name="author" content="Ruoqing Zhu, PhD" />


<meta name="date" content="2021-10-09" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  <link rel="shortcut icon" href="favicon.ico" type="image/x-icon" />
<link rel="prev" href="kernel-smoothing.html"/>
<link rel="next" href="discriminant-analysis.html"/>
<script src="libs/header-attrs-2.10/header-attrs.js"></script>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.0.1/anchor-sections.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.0.1/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Statistical Learning and Machine Learning with R</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preface</a>
<ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#target-audience"><i class="fa fa-check"></i>Target Audience</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#whats-covered"><i class="fa fa-check"></i>What’s Covered?</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#acknowledgements"><i class="fa fa-check"></i>Acknowledgements</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#license"><i class="fa fa-check"></i>License</a></li>
</ul></li>
<li class="part"><span><b>I Basics Knowledge</b></span></li>
<li class="chapter" data-level="1" data-path="r-and-rstudio.html"><a href="r-and-rstudio.html"><i class="fa fa-check"></i><b>1</b> R and RStudio</a>
<ul>
<li class="chapter" data-level="1.1" data-path="r-and-rstudio.html"><a href="r-and-rstudio.html#installing-r-and-rstudio"><i class="fa fa-check"></i><b>1.1</b> Installing R and RStudio</a></li>
<li class="chapter" data-level="1.2" data-path="r-and-rstudio.html"><a href="r-and-rstudio.html#r-basic"><i class="fa fa-check"></i><b>1.2</b> Resources and Guides</a></li>
<li class="chapter" data-level="1.3" data-path="r-and-rstudio.html"><a href="r-and-rstudio.html#basic-mathematical-operations"><i class="fa fa-check"></i><b>1.3</b> Basic Mathematical Operations</a></li>
<li class="chapter" data-level="1.4" data-path="r-and-rstudio.html"><a href="r-and-rstudio.html#data-objects"><i class="fa fa-check"></i><b>1.4</b> Data Objects</a></li>
<li class="chapter" data-level="1.5" data-path="r-and-rstudio.html"><a href="r-and-rstudio.html#readin-and-save-data"><i class="fa fa-check"></i><b>1.5</b> Readin and save data</a></li>
<li class="chapter" data-level="1.6" data-path="r-and-rstudio.html"><a href="r-and-rstudio.html#using-and-defining-functions"><i class="fa fa-check"></i><b>1.6</b> Using and defining functions</a></li>
<li class="chapter" data-level="1.7" data-path="r-and-rstudio.html"><a href="r-and-rstudio.html#distribution-and-random-numbers"><i class="fa fa-check"></i><b>1.7</b> Distribution and random numbers</a></li>
<li class="chapter" data-level="1.8" data-path="r-and-rstudio.html"><a href="r-and-rstudio.html#using-packages-and-other-resources"><i class="fa fa-check"></i><b>1.8</b> Using packages and other resources</a></li>
<li class="chapter" data-level="1.9" data-path="r-and-rstudio.html"><a href="r-and-rstudio.html#practice-questions"><i class="fa fa-check"></i><b>1.9</b> Practice questions</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="rmarkdown.html"><a href="rmarkdown.html"><i class="fa fa-check"></i><b>2</b> RMarkdown</a>
<ul>
<li class="chapter" data-level="2.1" data-path="rmarkdown.html"><a href="rmarkdown.html#basics-and-resources"><i class="fa fa-check"></i><b>2.1</b> Basics and Resources</a></li>
<li class="chapter" data-level="2.2" data-path="rmarkdown.html"><a href="rmarkdown.html#formatting-text"><i class="fa fa-check"></i><b>2.2</b> Formatting Text</a></li>
<li class="chapter" data-level="2.3" data-path="rmarkdown.html"><a href="rmarkdown.html#adding-r-code"><i class="fa fa-check"></i><b>2.3</b> Adding <code>R</code> Code</a>
<ul>
<li class="chapter" data-level="2.3.1" data-path="rmarkdown.html"><a href="rmarkdown.html#r-chunks"><i class="fa fa-check"></i><b>2.3.1</b> <code>R</code> Chunks</a></li>
<li class="chapter" data-level="2.3.2" data-path="rmarkdown.html"><a href="rmarkdown.html#inline-r"><i class="fa fa-check"></i><b>2.3.2</b> Inline <code>R</code></a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="rmarkdown.html"><a href="rmarkdown.html#importing-data"><i class="fa fa-check"></i><b>2.4</b> Importing Data</a></li>
<li class="chapter" data-level="2.5" data-path="rmarkdown.html"><a href="rmarkdown.html#working-directory"><i class="fa fa-check"></i><b>2.5</b> Working Directory</a></li>
<li class="chapter" data-level="2.6" data-path="rmarkdown.html"><a href="rmarkdown.html#plotting"><i class="fa fa-check"></i><b>2.6</b> Plotting</a></li>
<li class="chapter" data-level="2.7" data-path="rmarkdown.html"><a href="rmarkdown.html#chunk-options"><i class="fa fa-check"></i><b>2.7</b> Chunk Options</a></li>
<li class="chapter" data-level="2.8" data-path="rmarkdown.html"><a href="rmarkdown.html#adding-math-with-latex"><i class="fa fa-check"></i><b>2.8</b> Adding Math with LaTeX</a>
<ul>
<li class="chapter" data-level="2.8.1" data-path="rmarkdown.html"><a href="rmarkdown.html#displaystyle-latex"><i class="fa fa-check"></i><b>2.8.1</b> Displaystyle LaTeX</a></li>
<li class="chapter" data-level="2.8.2" data-path="rmarkdown.html"><a href="rmarkdown.html#inline-latex"><i class="fa fa-check"></i><b>2.8.2</b> Inline LaTex</a></li>
</ul></li>
<li class="chapter" data-level="2.9" data-path="rmarkdown.html"><a href="rmarkdown.html#output-options"><i class="fa fa-check"></i><b>2.9</b> Output Options</a></li>
<li class="chapter" data-level="2.10" data-path="rmarkdown.html"><a href="rmarkdown.html#try-it"><i class="fa fa-check"></i><b>2.10</b> Try It!</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="linear-algebra-basics.html"><a href="linear-algebra-basics.html"><i class="fa fa-check"></i><b>3</b> Linear Algebra Basics</a>
<ul>
<li class="chapter" data-level="3.1" data-path="linear-algebra-basics.html"><a href="linear-algebra-basics.html#definition"><i class="fa fa-check"></i><b>3.1</b> Definition</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="optimization-basics.html"><a href="optimization-basics.html"><i class="fa fa-check"></i><b>4</b> Optimization Basics</a>
<ul>
<li class="chapter" data-level="4.1" data-path="optimization-basics.html"><a href="optimization-basics.html#basic-concept"><i class="fa fa-check"></i><b>4.1</b> Basic Concept</a></li>
<li class="chapter" data-level="4.2" data-path="optimization-basics.html"><a href="optimization-basics.html#global_local"><i class="fa fa-check"></i><b>4.2</b> Global vs. Local Optima</a></li>
<li class="chapter" data-level="4.3" data-path="optimization-basics.html"><a href="optimization-basics.html#example-linear-regression-using-optim"><i class="fa fa-check"></i><b>4.3</b> Example: Linear Regression using <code>optim()</code></a></li>
<li class="chapter" data-level="4.4" data-path="optimization-basics.html"><a href="optimization-basics.html#first-and-second-order-properties"><i class="fa fa-check"></i><b>4.4</b> First and Second Order Properties</a></li>
<li class="chapter" data-level="4.5" data-path="optimization-basics.html"><a href="optimization-basics.html#algorithm"><i class="fa fa-check"></i><b>4.5</b> Algorithm</a></li>
<li class="chapter" data-level="4.6" data-path="optimization-basics.html"><a href="optimization-basics.html#second-order-methods"><i class="fa fa-check"></i><b>4.6</b> Second-order Methods</a>
<ul>
<li class="chapter" data-level="4.6.1" data-path="optimization-basics.html"><a href="optimization-basics.html#newtons-method"><i class="fa fa-check"></i><b>4.6.1</b> Newton’s Method</a></li>
<li class="chapter" data-level="4.6.2" data-path="optimization-basics.html"><a href="optimization-basics.html#quasi-newton-methods"><i class="fa fa-check"></i><b>4.6.2</b> Quasi-Newton Methods</a></li>
</ul></li>
<li class="chapter" data-level="4.7" data-path="optimization-basics.html"><a href="optimization-basics.html#first-order-methods"><i class="fa fa-check"></i><b>4.7</b> First-order Methods</a>
<ul>
<li class="chapter" data-level="4.7.1" data-path="optimization-basics.html"><a href="optimization-basics.html#gradient-descent"><i class="fa fa-check"></i><b>4.7.1</b> Gradient Descent</a></li>
<li class="chapter" data-level="4.7.2" data-path="optimization-basics.html"><a href="optimization-basics.html#gradient-descent-example-linear-regression"><i class="fa fa-check"></i><b>4.7.2</b> Gradient Descent Example: Linear Regression</a></li>
</ul></li>
<li class="chapter" data-level="4.8" data-path="optimization-basics.html"><a href="optimization-basics.html#coordinate"><i class="fa fa-check"></i><b>4.8</b> Coordinate Descent</a>
<ul>
<li class="chapter" data-level="4.8.1" data-path="optimization-basics.html"><a href="optimization-basics.html#coordinate-descent-example-linear-regression"><i class="fa fa-check"></i><b>4.8.1</b> Coordinate Descent Example: Linear Regression</a></li>
</ul></li>
<li class="chapter" data-level="4.9" data-path="optimization-basics.html"><a href="optimization-basics.html#stocastic-gradient-descent"><i class="fa fa-check"></i><b>4.9</b> Stocastic Gradient Descent</a>
<ul>
<li class="chapter" data-level="4.9.1" data-path="optimization-basics.html"><a href="optimization-basics.html#mini-batch-stocastic-gradient-descent"><i class="fa fa-check"></i><b>4.9.1</b> Mini-batch Stocastic Gradient Descent</a></li>
</ul></li>
<li class="chapter" data-level="4.10" data-path="optimization-basics.html"><a href="optimization-basics.html#lagrangian-multiplier-for-constrained-problems"><i class="fa fa-check"></i><b>4.10</b> Lagrangian Multiplier for Constrained Problems</a></li>
</ul></li>
<li class="part"><span><b>II Linear and Penalized Linear Models</b></span></li>
<li class="chapter" data-level="5" data-path="linear-regression-and-model-selection.html"><a href="linear-regression-and-model-selection.html"><i class="fa fa-check"></i><b>5</b> Linear Regression and Model Selection</a>
<ul>
<li class="chapter" data-level="5.1" data-path="linear-regression-and-model-selection.html"><a href="linear-regression-and-model-selection.html#example-real-estate-data"><i class="fa fa-check"></i><b>5.1</b> Example: real estate data</a></li>
<li class="chapter" data-level="5.2" data-path="linear-regression-and-model-selection.html"><a href="linear-regression-and-model-selection.html#notation-and-basic-properties"><i class="fa fa-check"></i><b>5.2</b> Notation and Basic Properties</a></li>
<li class="chapter" data-level="5.3" data-path="linear-regression-and-model-selection.html"><a href="linear-regression-and-model-selection.html#using-the-lm-function"><i class="fa fa-check"></i><b>5.3</b> Using the <code>lm()</code> Function</a>
<ul>
<li class="chapter" data-level="5.3.1" data-path="linear-regression-and-model-selection.html"><a href="linear-regression-and-model-selection.html#adding-covariates"><i class="fa fa-check"></i><b>5.3.1</b> Adding Covariates</a></li>
<li class="chapter" data-level="5.3.2" data-path="linear-regression-and-model-selection.html"><a href="linear-regression-and-model-selection.html#categorical-variables"><i class="fa fa-check"></i><b>5.3.2</b> Categorical Variables</a></li>
</ul></li>
<li class="chapter" data-level="5.4" data-path="linear-regression-and-model-selection.html"><a href="linear-regression-and-model-selection.html#model-selection-criteria"><i class="fa fa-check"></i><b>5.4</b> Model Selection Criteria</a>
<ul>
<li class="chapter" data-level="5.4.1" data-path="linear-regression-and-model-selection.html"><a href="linear-regression-and-model-selection.html#using-marrows-c_p"><i class="fa fa-check"></i><b>5.4.1</b> Using Marrows’ <span class="math inline">\(C_p\)</span></a></li>
<li class="chapter" data-level="5.4.2" data-path="linear-regression-and-model-selection.html"><a href="linear-regression-and-model-selection.html#using-aic-and-bic"><i class="fa fa-check"></i><b>5.4.2</b> Using AIC and BIC</a></li>
</ul></li>
<li class="chapter" data-level="5.5" data-path="linear-regression-and-model-selection.html"><a href="linear-regression-and-model-selection.html#model-selection-algorithms"><i class="fa fa-check"></i><b>5.5</b> Model Selection Algorithms</a>
<ul>
<li class="chapter" data-level="5.5.1" data-path="linear-regression-and-model-selection.html"><a href="linear-regression-and-model-selection.html#best-subset-selection-with-leaps"><i class="fa fa-check"></i><b>5.5.1</b> Best Subset Selection with <code>leaps</code></a></li>
<li class="chapter" data-level="5.5.2" data-path="linear-regression-and-model-selection.html"><a href="linear-regression-and-model-selection.html#step-wise-regression-using-step"><i class="fa fa-check"></i><b>5.5.2</b> Step-wise regression using <code>step()</code></a></li>
</ul></li>
<li class="chapter" data-level="5.6" data-path="linear-regression-and-model-selection.html"><a href="linear-regression-and-model-selection.html#marrows-cp"><i class="fa fa-check"></i><b>5.6</b> Derivation of Marrows’ <span class="math inline">\(C_p\)</span></a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="ridge-regression.html"><a href="ridge-regression.html"><i class="fa fa-check"></i><b>6</b> Ridge Regression</a>
<ul>
<li class="chapter" data-level="6.1" data-path="ridge-regression.html"><a href="ridge-regression.html#motivation-correlated-variables-and-convexity"><i class="fa fa-check"></i><b>6.1</b> Motivation: Correlated Variables and Convexity</a></li>
<li class="chapter" data-level="6.2" data-path="ridge-regression.html"><a href="ridge-regression.html#bias-and-variance-of-ridge-regression"><i class="fa fa-check"></i><b>6.2</b> Bias and Variance of Ridge Regression</a></li>
<li class="chapter" data-level="6.3" data-path="ridge-regression.html"><a href="ridge-regression.html#degrees-of-freedom"><i class="fa fa-check"></i><b>6.3</b> Degrees of Freedom</a></li>
<li class="chapter" data-level="6.4" data-path="ridge-regression.html"><a href="ridge-regression.html#using-the-lm.ridge-function"><i class="fa fa-check"></i><b>6.4</b> Using the <code>lm.ridge()</code> function</a>
<ul>
<li class="chapter" data-level="6.4.1" data-path="ridge-regression.html"><a href="ridge-regression.html#scaling-issue"><i class="fa fa-check"></i><b>6.4.1</b> Scaling Issue</a></li>
<li class="chapter" data-level="6.4.2" data-path="ridge-regression.html"><a href="ridge-regression.html#multiple-lambda-values"><i class="fa fa-check"></i><b>6.4.2</b> Multiple <span class="math inline">\(\lambda\)</span> values</a></li>
</ul></li>
<li class="chapter" data-level="6.5" data-path="ridge-regression.html"><a href="ridge-regression.html#cross-validation"><i class="fa fa-check"></i><b>6.5</b> Cross-validation</a></li>
<li class="chapter" data-level="6.6" data-path="ridge-regression.html"><a href="ridge-regression.html#leave-one-out-cross-validation"><i class="fa fa-check"></i><b>6.6</b> Leave-one-out cross-validation</a>
<ul>
<li class="chapter" data-level="6.6.1" data-path="ridge-regression.html"><a href="ridge-regression.html#generalized-cross-validation"><i class="fa fa-check"></i><b>6.6.1</b> Generalized cross-validation</a></li>
</ul></li>
<li class="chapter" data-level="6.7" data-path="ridge-regression.html"><a href="ridge-regression.html#the-glmnet-package"><i class="fa fa-check"></i><b>6.7</b> The <code>glmnet</code> package</a>
<ul>
<li class="chapter" data-level="6.7.1" data-path="ridge-regression.html"><a href="ridge-regression.html#scaling-issue-1"><i class="fa fa-check"></i><b>6.7.1</b> Scaling Issue</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="7" data-path="lasso.html"><a href="lasso.html"><i class="fa fa-check"></i><b>7</b> Lasso</a>
<ul>
<li class="chapter" data-level="7.1" data-path="lasso.html"><a href="lasso.html#one-variable-lasso-and-shrinkage"><i class="fa fa-check"></i><b>7.1</b> One-Variable Lasso and Shrinkage</a></li>
<li class="chapter" data-level="7.2" data-path="lasso.html"><a href="lasso.html#constrained-optimization-view"><i class="fa fa-check"></i><b>7.2</b> Constrained Optimization View</a></li>
<li class="chapter" data-level="7.3" data-path="lasso.html"><a href="lasso.html#the-solution-path"><i class="fa fa-check"></i><b>7.3</b> The Solution Path</a></li>
<li class="chapter" data-level="7.4" data-path="lasso.html"><a href="lasso.html#path-wise-coordinate-descent"><i class="fa fa-check"></i><b>7.4</b> Path-wise Coordinate Descent</a></li>
<li class="chapter" data-level="7.5" data-path="lasso.html"><a href="lasso.html#using-the-glmnet-package"><i class="fa fa-check"></i><b>7.5</b> Using the <code>glmnet</code> package</a></li>
<li class="chapter" data-level="7.6" data-path="lasso.html"><a href="lasso.html#elastic-net"><i class="fa fa-check"></i><b>7.6</b> Elastic-Net</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="spline.html"><a href="spline.html"><i class="fa fa-check"></i><b>8</b> Spline</a></li>
<li class="part"><span><b>III Nonparametric Models through Local Averaging</b></span></li>
<li class="chapter" data-level="9" data-path="k-neariest-neighber.html"><a href="k-neariest-neighber.html"><i class="fa fa-check"></i><b>9</b> K-Neariest Neighber</a>
<ul>
<li class="chapter" data-level="9.1" data-path="k-neariest-neighber.html"><a href="k-neariest-neighber.html#definition-1"><i class="fa fa-check"></i><b>9.1</b> Definition</a></li>
<li class="chapter" data-level="9.2" data-path="k-neariest-neighber.html"><a href="k-neariest-neighber.html#tuning-k"><i class="fa fa-check"></i><b>9.2</b> Tuning <span class="math inline">\(k\)</span></a></li>
<li class="chapter" data-level="9.3" data-path="k-neariest-neighber.html"><a href="k-neariest-neighber.html#the-bias-variance-trade-off"><i class="fa fa-check"></i><b>9.3</b> The Bias-variance Trade-off</a></li>
<li class="chapter" data-level="9.4" data-path="k-neariest-neighber.html"><a href="k-neariest-neighber.html#knn-for-classification"><i class="fa fa-check"></i><b>9.4</b> KNN for Classification</a></li>
<li class="chapter" data-level="9.5" data-path="k-neariest-neighber.html"><a href="k-neariest-neighber.html#example-1-an-artificial-data"><i class="fa fa-check"></i><b>9.5</b> Example 1: An artificial data</a></li>
<li class="chapter" data-level="9.6" data-path="k-neariest-neighber.html"><a href="k-neariest-neighber.html#tuning-with-the-caret-package"><i class="fa fa-check"></i><b>9.6</b> Tuning with the <code>caret</code> Package</a></li>
<li class="chapter" data-level="9.7" data-path="k-neariest-neighber.html"><a href="k-neariest-neighber.html#distance-measures"><i class="fa fa-check"></i><b>9.7</b> Distance Measures</a></li>
<li class="chapter" data-level="9.8" data-path="k-neariest-neighber.html"><a href="k-neariest-neighber.html#nn-error-bound"><i class="fa fa-check"></i><b>9.8</b> 1NN Error Bound</a></li>
<li class="chapter" data-level="9.9" data-path="k-neariest-neighber.html"><a href="k-neariest-neighber.html#example-2-handwritten-digit-data"><i class="fa fa-check"></i><b>9.9</b> Example 2: Handwritten Digit Data</a></li>
<li class="chapter" data-level="9.10" data-path="k-neariest-neighber.html"><a href="k-neariest-neighber.html#curse-of-dimensionality"><i class="fa fa-check"></i><b>9.10</b> Curse of Dimensionality</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="kernel-smoothing.html"><a href="kernel-smoothing.html"><i class="fa fa-check"></i><b>10</b> Kernel Smoothing</a>
<ul>
<li class="chapter" data-level="10.1" data-path="kernel-smoothing.html"><a href="kernel-smoothing.html#knn-vs.-kernel"><i class="fa fa-check"></i><b>10.1</b> KNN vs. Kernel</a></li>
<li class="chapter" data-level="10.2" data-path="kernel-smoothing.html"><a href="kernel-smoothing.html#kernel-density-estimations"><i class="fa fa-check"></i><b>10.2</b> Kernel Density Estimations</a></li>
<li class="chapter" data-level="10.3" data-path="kernel-smoothing.html"><a href="kernel-smoothing.html#bias-variance-trade-off"><i class="fa fa-check"></i><b>10.3</b> Bias-variance trade-off</a></li>
<li class="chapter" data-level="10.4" data-path="kernel-smoothing.html"><a href="kernel-smoothing.html#gaussian-kernel-regression"><i class="fa fa-check"></i><b>10.4</b> Gaussian Kernel Regression</a>
<ul>
<li class="chapter" data-level="10.4.1" data-path="kernel-smoothing.html"><a href="kernel-smoothing.html#bias-variance-trade-off-1"><i class="fa fa-check"></i><b>10.4.1</b> Bias-variance Trade-off</a></li>
</ul></li>
<li class="chapter" data-level="10.5" data-path="kernel-smoothing.html"><a href="kernel-smoothing.html#choice-of-kernel-functions"><i class="fa fa-check"></i><b>10.5</b> Choice of Kernel Functions</a></li>
<li class="chapter" data-level="10.6" data-path="kernel-smoothing.html"><a href="kernel-smoothing.html#local-linear-regression"><i class="fa fa-check"></i><b>10.6</b> Local Linear Regression</a></li>
<li class="chapter" data-level="10.7" data-path="kernel-smoothing.html"><a href="kernel-smoothing.html#local-polynomial-regression"><i class="fa fa-check"></i><b>10.7</b> Local Polynomial Regression</a></li>
<li class="chapter" data-level="10.8" data-path="kernel-smoothing.html"><a href="kernel-smoothing.html#r-implementations"><i class="fa fa-check"></i><b>10.8</b> R Implementations</a></li>
</ul></li>
<li class="part"><span><b>IV Classification Models</b></span></li>
<li class="chapter" data-level="11" data-path="logistic-regression-basics.html"><a href="logistic-regression-basics.html"><i class="fa fa-check"></i><b>11</b> Logistic Regression Basics</a>
<ul>
<li class="chapter" data-level="11.1" data-path="logistic-regression-basics.html"><a href="logistic-regression-basics.html#example-south-africa-heart-data"><i class="fa fa-check"></i><b>11.1</b> Example: South Africa Heart Data</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="discriminant-analysis.html"><a href="discriminant-analysis.html"><i class="fa fa-check"></i><b>12</b> Discriminant Analysis</a>
<ul>
<li class="chapter" data-level="12.1" data-path="discriminant-analysis.html"><a href="discriminant-analysis.html#linear-discriminant-analysis"><i class="fa fa-check"></i><b>12.1</b> Linear Discriminant Analysis</a></li>
<li class="chapter" data-level="12.2" data-path="discriminant-analysis.html"><a href="discriminant-analysis.html#example-the-hand-written-digit-data"><i class="fa fa-check"></i><b>12.2</b> Example: the Hand Written Digit Data</a></li>
</ul></li>
<li class="part"><span><b>V Reference</b></span></li>
<li class="chapter" data-level="13" data-path="reference.html"><a href="reference.html"><i class="fa fa-check"></i><b>13</b> Reference</a></li>
<li class="divider"></li>
<li><a href="https://github.com/teazrq/SMLR" target="blank">&copy; 2021 Ruoqing Zhu</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Statistical Learning and Machine Learning with R</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="logistic-regression-basics" class="section level1" number="11">
<h1><span class="header-section-number">Chapter 11</span> Logistic Regression Basics</h1>
<div id="example-south-africa-heart-data" class="section level2" number="11.1">
<h2><span class="header-section-number">11.1</span> Example: South Africa Heart Data</h2>
<p>We use the South Africa heart data as a demonstration. The goal is to estimate the probability of <code>chd</code>, the indicator of coronary heart disease.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="logistic-regression-basics.html#cb1-1" aria-hidden="true" tabindex="-1"></a>    <span class="fu">library</span>(ElemStatLearn)</span>
<span id="cb1-2"><a href="logistic-regression-basics.html#cb1-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">data</span>(SAheart)</span>
<span id="cb1-3"><a href="logistic-regression-basics.html#cb1-3" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb1-4"><a href="logistic-regression-basics.html#cb1-4" aria-hidden="true" tabindex="-1"></a>    heart <span class="ot">=</span> SAheart</span>
<span id="cb1-5"><a href="logistic-regression-basics.html#cb1-5" aria-hidden="true" tabindex="-1"></a>    heart<span class="sc">$</span>famhist <span class="ot">=</span> <span class="fu">as.numeric</span>(heart<span class="sc">$</span>famhist)<span class="sc">-</span><span class="dv">1</span></span>
<span id="cb1-6"><a href="logistic-regression-basics.html#cb1-6" aria-hidden="true" tabindex="-1"></a>    n <span class="ot">=</span> <span class="fu">nrow</span>(heart)</span>
<span id="cb1-7"><a href="logistic-regression-basics.html#cb1-7" aria-hidden="true" tabindex="-1"></a>    p <span class="ot">=</span> <span class="fu">ncol</span>(heart)</span>
<span id="cb1-8"><a href="logistic-regression-basics.html#cb1-8" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb1-9"><a href="logistic-regression-basics.html#cb1-9" aria-hidden="true" tabindex="-1"></a>    heart.full <span class="ot">=</span> <span class="fu">glm</span>(chd<span class="sc">~</span>., <span class="at">data=</span>heart, <span class="at">family=</span>binomial)</span>
<span id="cb1-10"><a href="logistic-regression-basics.html#cb1-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">round</span>(<span class="fu">summary</span>(heart.full)<span class="sc">$</span>coef, <span class="at">dig=</span><span class="dv">3</span>)</span>
<span id="cb1-11"><a href="logistic-regression-basics.html#cb1-11" aria-hidden="true" tabindex="-1"></a><span class="do">##             Estimate Std. Error z value Pr(&gt;|z|)</span></span>
<span id="cb1-12"><a href="logistic-regression-basics.html#cb1-12" aria-hidden="true" tabindex="-1"></a><span class="do">## (Intercept)   -6.151      1.308  -4.701    0.000</span></span>
<span id="cb1-13"><a href="logistic-regression-basics.html#cb1-13" aria-hidden="true" tabindex="-1"></a><span class="do">## sbp            0.007      0.006   1.135    0.256</span></span>
<span id="cb1-14"><a href="logistic-regression-basics.html#cb1-14" aria-hidden="true" tabindex="-1"></a><span class="do">## tobacco        0.079      0.027   2.984    0.003</span></span>
<span id="cb1-15"><a href="logistic-regression-basics.html#cb1-15" aria-hidden="true" tabindex="-1"></a><span class="do">## ldl            0.174      0.060   2.915    0.004</span></span>
<span id="cb1-16"><a href="logistic-regression-basics.html#cb1-16" aria-hidden="true" tabindex="-1"></a><span class="do">## adiposity      0.019      0.029   0.635    0.526</span></span>
<span id="cb1-17"><a href="logistic-regression-basics.html#cb1-17" aria-hidden="true" tabindex="-1"></a><span class="do">## famhist        0.925      0.228   4.061    0.000</span></span>
<span id="cb1-18"><a href="logistic-regression-basics.html#cb1-18" aria-hidden="true" tabindex="-1"></a><span class="do">## typea          0.040      0.012   3.214    0.001</span></span>
<span id="cb1-19"><a href="logistic-regression-basics.html#cb1-19" aria-hidden="true" tabindex="-1"></a><span class="do">## obesity       -0.063      0.044  -1.422    0.155</span></span>
<span id="cb1-20"><a href="logistic-regression-basics.html#cb1-20" aria-hidden="true" tabindex="-1"></a><span class="do">## alcohol        0.000      0.004   0.027    0.978</span></span>
<span id="cb1-21"><a href="logistic-regression-basics.html#cb1-21" aria-hidden="true" tabindex="-1"></a><span class="do">## age            0.045      0.012   3.728    0.000</span></span>
<span id="cb1-22"><a href="logistic-regression-basics.html#cb1-22" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb1-23"><a href="logistic-regression-basics.html#cb1-23" aria-hidden="true" tabindex="-1"></a>    <span class="co"># fitted value </span></span>
<span id="cb1-24"><a href="logistic-regression-basics.html#cb1-24" aria-hidden="true" tabindex="-1"></a>    yhat <span class="ot">=</span> (heart.full<span class="sc">$</span>fitted.values<span class="sc">&gt;</span><span class="fl">0.5</span>)</span>
<span id="cb1-25"><a href="logistic-regression-basics.html#cb1-25" aria-hidden="true" tabindex="-1"></a>    <span class="fu">table</span>(yhat, SAheart<span class="sc">$</span>chd)</span>
<span id="cb1-26"><a href="logistic-regression-basics.html#cb1-26" aria-hidden="true" tabindex="-1"></a><span class="do">##        </span></span>
<span id="cb1-27"><a href="logistic-regression-basics.html#cb1-27" aria-hidden="true" tabindex="-1"></a><span class="do">## yhat      0   1</span></span>
<span id="cb1-28"><a href="logistic-regression-basics.html#cb1-28" aria-hidden="true" tabindex="-1"></a><span class="do">##   FALSE 256  77</span></span>
<span id="cb1-29"><a href="logistic-regression-basics.html#cb1-29" aria-hidden="true" tabindex="-1"></a><span class="do">##   TRUE   46  83</span></span></code></pre></div>
<p>Based on what we learned in class, we can solve this problem ourselves using numerical optimization. Here we will demonstrate an approach that uses general solvers. First, write the objective function of the logistic regression, for any value of <span class="math inline">\(\boldsymbol \beta\)</span>, <span class="math inline">\(\mathbf{X}\)</span> and <span class="math inline">\(\mathbf{y}\)</span>.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="logistic-regression-basics.html#cb2-1" aria-hidden="true" tabindex="-1"></a>    <span class="co"># the negative log-likelihood function of logistic regression </span></span>
<span id="cb2-2"><a href="logistic-regression-basics.html#cb2-2" aria-hidden="true" tabindex="-1"></a>    my.loglik <span class="ot">&lt;-</span> <span class="cf">function</span>(b, x, y)</span>
<span id="cb2-3"><a href="logistic-regression-basics.html#cb2-3" aria-hidden="true" tabindex="-1"></a>    {</span>
<span id="cb2-4"><a href="logistic-regression-basics.html#cb2-4" aria-hidden="true" tabindex="-1"></a>        bm <span class="ot">=</span> <span class="fu">as.matrix</span>(b)</span>
<span id="cb2-5"><a href="logistic-regression-basics.html#cb2-5" aria-hidden="true" tabindex="-1"></a>        xb <span class="ot">=</span>  x <span class="sc">%*%</span> bm</span>
<span id="cb2-6"><a href="logistic-regression-basics.html#cb2-6" aria-hidden="true" tabindex="-1"></a>        <span class="co"># this returns the negative loglikelihood</span></span>
<span id="cb2-7"><a href="logistic-regression-basics.html#cb2-7" aria-hidden="true" tabindex="-1"></a>        <span class="fu">return</span>(<span class="fu">sum</span>(y<span class="sc">*</span>xb) <span class="sc">-</span> <span class="fu">sum</span>(<span class="fu">log</span>(<span class="dv">1</span> <span class="sc">+</span> <span class="fu">exp</span>(xb))))</span>
<span id="cb2-8"><a href="logistic-regression-basics.html#cb2-8" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb2-9"><a href="logistic-regression-basics.html#cb2-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-10"><a href="logistic-regression-basics.html#cb2-10" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Gradient</span></span>
<span id="cb2-11"><a href="logistic-regression-basics.html#cb2-11" aria-hidden="true" tabindex="-1"></a>    my.gradient <span class="ot">&lt;-</span> <span class="cf">function</span>(b, x, y)</span>
<span id="cb2-12"><a href="logistic-regression-basics.html#cb2-12" aria-hidden="true" tabindex="-1"></a>    {</span>
<span id="cb2-13"><a href="logistic-regression-basics.html#cb2-13" aria-hidden="true" tabindex="-1"></a>        bm <span class="ot">=</span> <span class="fu">as.matrix</span>(b) </span>
<span id="cb2-14"><a href="logistic-regression-basics.html#cb2-14" aria-hidden="true" tabindex="-1"></a>        expxb <span class="ot">=</span>  <span class="fu">exp</span>(x <span class="sc">%*%</span> bm)</span>
<span id="cb2-15"><a href="logistic-regression-basics.html#cb2-15" aria-hidden="true" tabindex="-1"></a>        <span class="fu">return</span>(<span class="fu">t</span>(x) <span class="sc">%*%</span> (y <span class="sc">-</span> expxb<span class="sc">/</span>(<span class="dv">1</span><span class="sc">+</span>expxb)))</span>
<span id="cb2-16"><a href="logistic-regression-basics.html#cb2-16" aria-hidden="true" tabindex="-1"></a>    }</span></code></pre></div>
<p>Let’s check the result of this function for some arbitrary <span class="math inline">\(\boldsymbol \beta\)</span> value.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="logistic-regression-basics.html#cb3-1" aria-hidden="true" tabindex="-1"></a>    <span class="co"># prepare the data matrix, I am adding a column of 1 for intercept</span></span>
<span id="cb3-2"><a href="logistic-regression-basics.html#cb3-2" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb3-3"><a href="logistic-regression-basics.html#cb3-3" aria-hidden="true" tabindex="-1"></a>    x <span class="ot">=</span> <span class="fu">as.matrix</span>(<span class="fu">cbind</span>(<span class="st">&quot;intercept&quot;</span> <span class="ot">=</span> <span class="dv">1</span>, heart[, <span class="dv">1</span><span class="sc">:</span><span class="dv">9</span>]))</span>
<span id="cb3-4"><a href="logistic-regression-basics.html#cb3-4" aria-hidden="true" tabindex="-1"></a>    y <span class="ot">=</span> <span class="fu">as.matrix</span>(heart[,<span class="dv">10</span>])</span>
<span id="cb3-5"><a href="logistic-regression-basics.html#cb3-5" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb3-6"><a href="logistic-regression-basics.html#cb3-6" aria-hidden="true" tabindex="-1"></a>    <span class="co"># check my function</span></span>
<span id="cb3-7"><a href="logistic-regression-basics.html#cb3-7" aria-hidden="true" tabindex="-1"></a>    b <span class="ot">=</span> <span class="fu">rep</span>(<span class="dv">0</span>, <span class="fu">ncol</span>(x))</span>
<span id="cb3-8"><a href="logistic-regression-basics.html#cb3-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">my.loglik</span>(b, x, y) <span class="co"># scaler</span></span>
<span id="cb3-9"><a href="logistic-regression-basics.html#cb3-9" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] -320.234</span></span>
<span id="cb3-10"><a href="logistic-regression-basics.html#cb3-10" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb3-11"><a href="logistic-regression-basics.html#cb3-11" aria-hidden="true" tabindex="-1"></a>    <span class="co"># check the optimal value and the likelihood</span></span>
<span id="cb3-12"><a href="logistic-regression-basics.html#cb3-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">my.loglik</span>(heart.full<span class="sc">$</span>coefficients, x, y)</span>
<span id="cb3-13"><a href="logistic-regression-basics.html#cb3-13" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] -236.07</span></span></code></pre></div>
<p>Then we optimize this objective function</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="logistic-regression-basics.html#cb4-1" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Use a general solver to get the optimal value</span></span>
<span id="cb4-2"><a href="logistic-regression-basics.html#cb4-2" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Note that we are doing maximizaiton instead of minimization, hence, need to specify &quot;fnscale&quot; = -1</span></span>
<span id="cb4-3"><a href="logistic-regression-basics.html#cb4-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">optim</span>(b, <span class="at">fn =</span> my.loglik, <span class="at">gr =</span> my.gradient, </span>
<span id="cb4-4"><a href="logistic-regression-basics.html#cb4-4" aria-hidden="true" tabindex="-1"></a>          <span class="at">method =</span> <span class="st">&quot;BFGS&quot;</span>, <span class="at">x =</span> x, <span class="at">y =</span> y, <span class="at">control =</span> <span class="fu">list</span>(<span class="st">&quot;fnscale&quot;</span> <span class="ot">=</span> <span class="sc">-</span><span class="dv">1</span>))</span>
<span id="cb4-5"><a href="logistic-regression-basics.html#cb4-5" aria-hidden="true" tabindex="-1"></a><span class="do">## $par</span></span>
<span id="cb4-6"><a href="logistic-regression-basics.html#cb4-6" aria-hidden="true" tabindex="-1"></a><span class="do">##  [1] -6.150733305  0.006504017  0.079376464  0.173923988  0.018586578  0.925372019  0.039595096</span></span>
<span id="cb4-7"><a href="logistic-regression-basics.html#cb4-7" aria-hidden="true" tabindex="-1"></a><span class="do">##  [8] -0.062909867  0.000121675  0.045225500</span></span>
<span id="cb4-8"><a href="logistic-regression-basics.html#cb4-8" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb4-9"><a href="logistic-regression-basics.html#cb4-9" aria-hidden="true" tabindex="-1"></a><span class="do">## $value</span></span>
<span id="cb4-10"><a href="logistic-regression-basics.html#cb4-10" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] -236.07</span></span>
<span id="cb4-11"><a href="logistic-regression-basics.html#cb4-11" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb4-12"><a href="logistic-regression-basics.html#cb4-12" aria-hidden="true" tabindex="-1"></a><span class="do">## $counts</span></span>
<span id="cb4-13"><a href="logistic-regression-basics.html#cb4-13" aria-hidden="true" tabindex="-1"></a><span class="do">## function gradient </span></span>
<span id="cb4-14"><a href="logistic-regression-basics.html#cb4-14" aria-hidden="true" tabindex="-1"></a><span class="do">##       74       16 </span></span>
<span id="cb4-15"><a href="logistic-regression-basics.html#cb4-15" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb4-16"><a href="logistic-regression-basics.html#cb4-16" aria-hidden="true" tabindex="-1"></a><span class="do">## $convergence</span></span>
<span id="cb4-17"><a href="logistic-regression-basics.html#cb4-17" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] 0</span></span>
<span id="cb4-18"><a href="logistic-regression-basics.html#cb4-18" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb4-19"><a href="logistic-regression-basics.html#cb4-19" aria-hidden="true" tabindex="-1"></a><span class="do">## $message</span></span>
<span id="cb4-20"><a href="logistic-regression-basics.html#cb4-20" aria-hidden="true" tabindex="-1"></a><span class="do">## NULL</span></span></code></pre></div>
<p>This matches our <code>glm()</code> solution. Now, if we do not have a general solver, we should consider using the Newton-Raphson. You need to write a function to calculate the Hessian matrix and proceed with an optimization update. Figure this out in your homework. The solution will be released later on.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="logistic-regression-basics.html#cb5-1" aria-hidden="true" tabindex="-1"></a>    <span class="co"># After defining some functions ... </span></span></code></pre></div>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="logistic-regression-basics.html#cb6-1" aria-hidden="true" tabindex="-1"></a>    <span class="co"># my Newton-Raphson method</span></span>
<span id="cb6-2"><a href="logistic-regression-basics.html#cb6-2" aria-hidden="true" tabindex="-1"></a>    <span class="co"># set up an initial value</span></span>
<span id="cb6-3"><a href="logistic-regression-basics.html#cb6-3" aria-hidden="true" tabindex="-1"></a>    <span class="co"># this is sometimes crucial...</span></span>
<span id="cb6-4"><a href="logistic-regression-basics.html#cb6-4" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb6-5"><a href="logistic-regression-basics.html#cb6-5" aria-hidden="true" tabindex="-1"></a>    b <span class="ot">=</span> <span class="fu">rep</span>(<span class="dv">0</span>, <span class="fu">ncol</span>(x))</span>
<span id="cb6-6"><a href="logistic-regression-basics.html#cb6-6" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb6-7"><a href="logistic-regression-basics.html#cb6-7" aria-hidden="true" tabindex="-1"></a>    mybeta <span class="ot">=</span> <span class="fu">my.logistic</span>(b, x, y, <span class="at">tol =</span> <span class="fl">1e-10</span>, <span class="at">maxitr =</span> <span class="dv">20</span>, </span>
<span id="cb6-8"><a href="logistic-regression-basics.html#cb6-8" aria-hidden="true" tabindex="-1"></a>                         <span class="at">gr =</span> my.gradient, <span class="at">hess =</span> my.hessian, <span class="at">verbose =</span> <span class="cn">TRUE</span>)</span>
<span id="cb6-9"><a href="logistic-regression-basics.html#cb6-9" aria-hidden="true" tabindex="-1"></a><span class="do">## at iteration 1, current beta is </span></span>
<span id="cb6-10"><a href="logistic-regression-basics.html#cb6-10" aria-hidden="true" tabindex="-1"></a><span class="do">## -4.032 0.005 0.066 0.133 0.009 0.694 0.024 -0.045 -0.001 0.027</span></span>
<span id="cb6-11"><a href="logistic-regression-basics.html#cb6-11" aria-hidden="true" tabindex="-1"></a><span class="do">## at iteration 2, current beta is </span></span>
<span id="cb6-12"><a href="logistic-regression-basics.html#cb6-12" aria-hidden="true" tabindex="-1"></a><span class="do">## -5.684 0.006 0.077 0.167 0.017 0.884 0.037 -0.061 0 0.041</span></span>
<span id="cb6-13"><a href="logistic-regression-basics.html#cb6-13" aria-hidden="true" tabindex="-1"></a><span class="do">## at iteration 3, current beta is </span></span>
<span id="cb6-14"><a href="logistic-regression-basics.html#cb6-14" aria-hidden="true" tabindex="-1"></a><span class="do">## -6.127 0.007 0.079 0.174 0.019 0.924 0.039 -0.063 0 0.045</span></span>
<span id="cb6-15"><a href="logistic-regression-basics.html#cb6-15" aria-hidden="true" tabindex="-1"></a><span class="do">## at iteration 4, current beta is </span></span>
<span id="cb6-16"><a href="logistic-regression-basics.html#cb6-16" aria-hidden="true" tabindex="-1"></a><span class="do">## -6.151 0.007 0.079 0.174 0.019 0.925 0.04 -0.063 0 0.045</span></span>
<span id="cb6-17"><a href="logistic-regression-basics.html#cb6-17" aria-hidden="true" tabindex="-1"></a><span class="do">## at iteration 5, current beta is </span></span>
<span id="cb6-18"><a href="logistic-regression-basics.html#cb6-18" aria-hidden="true" tabindex="-1"></a><span class="do">## -6.151 0.007 0.079 0.174 0.019 0.925 0.04 -0.063 0 0.045</span></span>
<span id="cb6-19"><a href="logistic-regression-basics.html#cb6-19" aria-hidden="true" tabindex="-1"></a><span class="do">## at iteration 6, current beta is </span></span>
<span id="cb6-20"><a href="logistic-regression-basics.html#cb6-20" aria-hidden="true" tabindex="-1"></a><span class="do">## -6.151 0.007 0.079 0.174 0.019 0.925 0.04 -0.063 0 0.045</span></span>
<span id="cb6-21"><a href="logistic-regression-basics.html#cb6-21" aria-hidden="true" tabindex="-1"></a><span class="do">## at iteration 7, current beta is </span></span>
<span id="cb6-22"><a href="logistic-regression-basics.html#cb6-22" aria-hidden="true" tabindex="-1"></a><span class="do">## -6.151 0.007 0.079 0.174 0.019 0.925 0.04 -0.063 0 0.045</span></span>
<span id="cb6-23"><a href="logistic-regression-basics.html#cb6-23" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb6-24"><a href="logistic-regression-basics.html#cb6-24" aria-hidden="true" tabindex="-1"></a>    <span class="co"># the parameter value</span></span>
<span id="cb6-25"><a href="logistic-regression-basics.html#cb6-25" aria-hidden="true" tabindex="-1"></a>    mybeta</span>
<span id="cb6-26"><a href="logistic-regression-basics.html#cb6-26" aria-hidden="true" tabindex="-1"></a><span class="do">##                    [,1]</span></span>
<span id="cb6-27"><a href="logistic-regression-basics.html#cb6-27" aria-hidden="true" tabindex="-1"></a><span class="do">## intercept -6.1507208650</span></span>
<span id="cb6-28"><a href="logistic-regression-basics.html#cb6-28" aria-hidden="true" tabindex="-1"></a><span class="do">## sbp        0.0065040171</span></span>
<span id="cb6-29"><a href="logistic-regression-basics.html#cb6-29" aria-hidden="true" tabindex="-1"></a><span class="do">## tobacco    0.0793764457</span></span>
<span id="cb6-30"><a href="logistic-regression-basics.html#cb6-30" aria-hidden="true" tabindex="-1"></a><span class="do">## ldl        0.1739238981</span></span>
<span id="cb6-31"><a href="logistic-regression-basics.html#cb6-31" aria-hidden="true" tabindex="-1"></a><span class="do">## adiposity  0.0185865682</span></span>
<span id="cb6-32"><a href="logistic-regression-basics.html#cb6-32" aria-hidden="true" tabindex="-1"></a><span class="do">## famhist    0.9253704194</span></span>
<span id="cb6-33"><a href="logistic-regression-basics.html#cb6-33" aria-hidden="true" tabindex="-1"></a><span class="do">## typea      0.0395950250</span></span>
<span id="cb6-34"><a href="logistic-regression-basics.html#cb6-34" aria-hidden="true" tabindex="-1"></a><span class="do">## obesity   -0.0629098693</span></span>
<span id="cb6-35"><a href="logistic-regression-basics.html#cb6-35" aria-hidden="true" tabindex="-1"></a><span class="do">## alcohol    0.0001216624</span></span>
<span id="cb6-36"><a href="logistic-regression-basics.html#cb6-36" aria-hidden="true" tabindex="-1"></a><span class="do">## age        0.0452253496</span></span>
<span id="cb6-37"><a href="logistic-regression-basics.html#cb6-37" aria-hidden="true" tabindex="-1"></a>    <span class="co"># get the standard error estimation </span></span>
<span id="cb6-38"><a href="logistic-regression-basics.html#cb6-38" aria-hidden="true" tabindex="-1"></a>    mysd <span class="ot">=</span> <span class="fu">sqrt</span>(<span class="fu">diag</span>(<span class="fu">solve</span>(<span class="sc">-</span><span class="fu">my.hessian</span>(mybeta, x, y))))    </span></code></pre></div>
<p>With this solution, I can then get the standard errors and the p-value. You can check them with the <code>glm()</code> function solution.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="logistic-regression-basics.html#cb7-1" aria-hidden="true" tabindex="-1"></a>    <span class="co"># my summary matrix</span></span>
<span id="cb7-2"><a href="logistic-regression-basics.html#cb7-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">round</span>(<span class="fu">data.frame</span>(<span class="st">&quot;beta&quot;</span> <span class="ot">=</span> mybeta, <span class="st">&quot;sd&quot;</span> <span class="ot">=</span> mysd, <span class="st">&quot;z&quot;</span> <span class="ot">=</span> mybeta<span class="sc">/</span>mysd, </span>
<span id="cb7-3"><a href="logistic-regression-basics.html#cb7-3" aria-hidden="true" tabindex="-1"></a>          <span class="st">&quot;pvalue&quot;</span> <span class="ot">=</span> <span class="dv">2</span><span class="sc">*</span>(<span class="dv">1</span><span class="sc">-</span><span class="fu">pnorm</span>(<span class="fu">abs</span>(mybeta<span class="sc">/</span>mysd)))), <span class="at">dig=</span><span class="dv">5</span>)</span>
<span id="cb7-4"><a href="logistic-regression-basics.html#cb7-4" aria-hidden="true" tabindex="-1"></a><span class="do">##               beta      sd        z  pvalue</span></span>
<span id="cb7-5"><a href="logistic-regression-basics.html#cb7-5" aria-hidden="true" tabindex="-1"></a><span class="do">## intercept -6.15072 1.30826 -4.70145 0.00000</span></span>
<span id="cb7-6"><a href="logistic-regression-basics.html#cb7-6" aria-hidden="true" tabindex="-1"></a><span class="do">## sbp        0.00650 0.00573  1.13500 0.25637</span></span>
<span id="cb7-7"><a href="logistic-regression-basics.html#cb7-7" aria-hidden="true" tabindex="-1"></a><span class="do">## tobacco    0.07938 0.02660  2.98376 0.00285</span></span>
<span id="cb7-8"><a href="logistic-regression-basics.html#cb7-8" aria-hidden="true" tabindex="-1"></a><span class="do">## ldl        0.17392 0.05966  2.91517 0.00355</span></span>
<span id="cb7-9"><a href="logistic-regression-basics.html#cb7-9" aria-hidden="true" tabindex="-1"></a><span class="do">## adiposity  0.01859 0.02929  0.63458 0.52570</span></span>
<span id="cb7-10"><a href="logistic-regression-basics.html#cb7-10" aria-hidden="true" tabindex="-1"></a><span class="do">## famhist    0.92537 0.22789  4.06053 0.00005</span></span>
<span id="cb7-11"><a href="logistic-regression-basics.html#cb7-11" aria-hidden="true" tabindex="-1"></a><span class="do">## typea      0.03960 0.01232  3.21382 0.00131</span></span>
<span id="cb7-12"><a href="logistic-regression-basics.html#cb7-12" aria-hidden="true" tabindex="-1"></a><span class="do">## obesity   -0.06291 0.04425 -1.42176 0.15509</span></span>
<span id="cb7-13"><a href="logistic-regression-basics.html#cb7-13" aria-hidden="true" tabindex="-1"></a><span class="do">## alcohol    0.00012 0.00448  0.02714 0.97835</span></span>
<span id="cb7-14"><a href="logistic-regression-basics.html#cb7-14" aria-hidden="true" tabindex="-1"></a><span class="do">## age        0.04523 0.01213  3.72846 0.00019</span></span>
<span id="cb7-15"><a href="logistic-regression-basics.html#cb7-15" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb7-16"><a href="logistic-regression-basics.html#cb7-16" aria-hidden="true" tabindex="-1"></a>    <span class="co"># check that with the glm fitting </span></span>
<span id="cb7-17"><a href="logistic-regression-basics.html#cb7-17" aria-hidden="true" tabindex="-1"></a>    <span class="fu">round</span>(<span class="fu">summary</span>(heart.full)<span class="sc">$</span>coef, <span class="at">dig=</span><span class="dv">5</span>)</span>
<span id="cb7-18"><a href="logistic-regression-basics.html#cb7-18" aria-hidden="true" tabindex="-1"></a><span class="do">##             Estimate Std. Error  z value Pr(&gt;|z|)</span></span>
<span id="cb7-19"><a href="logistic-regression-basics.html#cb7-19" aria-hidden="true" tabindex="-1"></a><span class="do">## (Intercept) -6.15072    1.30826 -4.70145  0.00000</span></span>
<span id="cb7-20"><a href="logistic-regression-basics.html#cb7-20" aria-hidden="true" tabindex="-1"></a><span class="do">## sbp          0.00650    0.00573  1.13500  0.25637</span></span>
<span id="cb7-21"><a href="logistic-regression-basics.html#cb7-21" aria-hidden="true" tabindex="-1"></a><span class="do">## tobacco      0.07938    0.02660  2.98376  0.00285</span></span>
<span id="cb7-22"><a href="logistic-regression-basics.html#cb7-22" aria-hidden="true" tabindex="-1"></a><span class="do">## ldl          0.17392    0.05966  2.91517  0.00355</span></span>
<span id="cb7-23"><a href="logistic-regression-basics.html#cb7-23" aria-hidden="true" tabindex="-1"></a><span class="do">## adiposity    0.01859    0.02929  0.63458  0.52570</span></span>
<span id="cb7-24"><a href="logistic-regression-basics.html#cb7-24" aria-hidden="true" tabindex="-1"></a><span class="do">## famhist      0.92537    0.22789  4.06053  0.00005</span></span>
<span id="cb7-25"><a href="logistic-regression-basics.html#cb7-25" aria-hidden="true" tabindex="-1"></a><span class="do">## typea        0.03960    0.01232  3.21382  0.00131</span></span>
<span id="cb7-26"><a href="logistic-regression-basics.html#cb7-26" aria-hidden="true" tabindex="-1"></a><span class="do">## obesity     -0.06291    0.04425 -1.42176  0.15509</span></span>
<span id="cb7-27"><a href="logistic-regression-basics.html#cb7-27" aria-hidden="true" tabindex="-1"></a><span class="do">## alcohol      0.00012    0.00448  0.02714  0.97835</span></span>
<span id="cb7-28"><a href="logistic-regression-basics.html#cb7-28" aria-hidden="true" tabindex="-1"></a><span class="do">## age          0.04523    0.01213  3.72846  0.00019</span></span></code></pre></div>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="kernel-smoothing.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="discriminant-analysis.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "sepia",
"family": "serif",
"size": 1
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "section"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
